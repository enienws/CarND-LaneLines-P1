# **Finding Lane Lines on the Road** 

## Writeup

### You can use this file as a template for your writeup if you want to submit it as a markdown file. But feel free to use some other method and submit a pdf if you prefer.

---

**Finding Lane Lines on the Road**

The goals / steps of this project are the following:
* Make a pipeline that finds lane lines on the road
* Reflect on your work in a written report


[//]: # (Image References)

[image1]: ./writeup_images/solidWhiteRight.jpg "Example Output"
[image2]: ./writeup_images/problematic_lanes.png "Problematic Lanes"
[image3]: ./writeup_images/output.png "Output"

---

### Reflection

### 1. Describe your pipeline. As part of the description, explain how you modified the draw_lines() function.

My pipeline consisted of 5 steps. Steps are explained below:

1. Colorspace conversion
In this phase, original colored images are transormed to grayscale color space. This is required because we do not need color information at all.

2. Gaussian Blur
Gaussian blur filter is applied on image in order to remove noises that cause canny edge detector to find small edges. 

3. Canny Edge Detector
Canny Edge Detector algorithm finds edges on given gray scale image. Canny edge detector can easily find lane lines as edges since lane lines make a great change in image (for example 0 -> 255 value change in extreme case).

4. ROI Definition
A ROI is defined within the image in order to remove edge information that is not required for lane lane detection. ROI Definition simply defines a region that is required for finding lanes  lines that the car is moving between.

5. Hough Line Transformation
Hough line transformation gets the image and transforms it to Hough Space. This transformation is required since slope for vertical lines cannot be defined.  After the transformation lines are filtered according to given threshold value. 

In order to draw a single line on the left and right lanes, I modified the draw_lines() function so that lane lines  that are belonging to left and right can be separated. I implemented this feature by calculating the slope of every line. Slope will be negative for left lines and positive for right lines. 

Here is an example output for overall pipeline:

![alt text][image1]


### 2. Identify potential shortcomings with your current pipeline

One possible shortcoming can be unable to detect edges for a given image. This method is mostly depending on Canny Edge Detector. In other words method trusts edge detector in order to find lanes in image transformed to hough space. However, there may be some conditions where canny edge detector unable to find edges. For example lane lines may on the asphalt may erased and in this case no edges will be found by canny edge detector. 

Additionally color information is not used in this pipeline. There are different colored lanes in real world and these lanes have some different meanings. Our pipeline ignores the color information by switching to grayscale color space. This means that our pipeline cannot comply with different scenarios generated by different colored lane lines. 

Another possible shortcoming can be related when switching across the lanes. The pipeline classifies lanes as left or right lanes according to the slopes of the lines. However left/right classification cannot be performed when switching lanes. 


### 3. Suggest possible improvements to your pipeline

As you can see in output videos pipeline sometimes generates lane lines that is originated from a left lane point but terminated at a right lane point or vice versa. The reason of problem is that slope of found lines are converging to zero for lane lines that are far away from the vehicle. According to tests that I have made, calculated slopes converge to zero for these lanes. Hence  of lines as  I implemented a small filter in order to remove this problem. The filter simply classifies a lane line as left if slope is smaller than -0.2 and classifies it as right if slope is bigger than 0.2. According to the tests, pipeline works better when mentioned filter is used however it cannot the solve problem totally. 

Continue working on the same problem after review, I have realized that small lane lines (lane lines in red circles below image) causes the problem. Slope calculation for these patches is not reliable and sometimes these patches are considered to be as left which brokes lanes integrity. In order to solve the problem I have increased the threshold given for hough_lines() function. Changing threshold from 10 to 30 solves the problem. 
![alt text][image2]

Additionally, as it is suggested in previous review, I have tried Numpy's polyfit function in order to draw solid lane lines. I used second order polynomials to model the lanes and these polynomials are used in order to draw the lanes. The form of polynomial is:
x = A*y^2 + B*y + C
calculate_polynomial() function simply evaluates the polynomial and outputs the corresponding x coordinate. 
Two method of lane lines are drawn on the image. Red one is the same as previous method, which draws a line between max_pt and min_pt. Green one is the polyline drawn by using polynomials fit to lanes. Below images shows an example output:
![alt text][image3]


As I have mentioned earlier in this report, additional techniques may be used in order to generate binary images. For example methods other than Canny Edge Detector may be used. Some additional methods are explained in Advanced Lane Finding project such as Sobel Filters, Color Channel Thresholdings, etc. 

A better way could extracting lane lines in a smaller RoI (RoI with smaller height) and drawing lane lines in a bigger area. These lines can be drawn using the slopes of extracted lane lines. In this method, I am expecting to get lane lines that are not totally fit to the lanes. However I think it worths to give a try to the method. 